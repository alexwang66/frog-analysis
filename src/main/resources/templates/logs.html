<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>File Download Volume Over Time</title>
    <!-- 引入 Semantic UI 样式表 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css">

    <!-- 引入 ECharts -->
    <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>

    <!-- 引入 jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
<div class="ui container">
    <h2 class="ui header">File Download Volume Over Time</h2>

    <!-- 创建一个用于展示 ECharts 图表的 div，设置宽度为 800px，高度为 1000px -->
    <div id="downloadVolumeChart" style="width: 400px; height: 600px;"></div>

    <!-- 使用 Thymeleaf 渲染未转义的时间标签数据 -->
    <script type="text/javascript">
        $(document).ready(function() {
            // 初始化 ECharts 实例
            var downloadVolumeChart = echarts.init(document.getElementById('downloadVolumeChart'));

            // 指定图表的配置项和数据
            var option = {
                title: {
                    text: 'File Download Volume Over Time'
                },
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    },
                    formatter: function (params) {
                        var date = new Date(params[0].axisValue);
                        return echarts.format.formatTime('MM/dd hh:mm', date) + '<br/>' + params[0].seriesName + ': ' + params[0].data;
                    }
                },
                xAxis: {
                    type: 'category',
                    data: [(${timeLabelsForJs})],  // 时间标签
                    axisLabel: {
                        formatter: function (value) {
                            return echarts.format.formatTime('MM/dd hh:mm', value);  // 格式化为 12 小时制
                        }
                    },
                    name: 'Time (Hours)'
                },
                yAxis: {
                    type: 'value',
                    axisLabel: {
                        formatter: function (value) {
                            return (value / (1024 * 1024 * 1024)).toFixed(2) + ' GB';  // 字节转换成 GB 并显示
                        }
                    },
                    name: 'Download Volume (GB)'
                },
                series: [{
                    name: 'Download Volume (GB)',
                    type: 'bar',
                    data: [(${downloadVolumes})],  // 下载量
                    itemStyle: {
                        color: 'rgba(75, 192, 192, 0.8)'
                    }
                }],
                dataZoom: [
                    {
                        type: 'slider', // 仅针对 x 轴的滑动条组件
                        start: 0,
                        end: 100
                    },
                    {
                        type: 'inside', // 支持 x 轴的鼠标滚动缩放
                        xAxisIndex: 0,
                        start: 0,
                        end: 100
                    }
                ],
                toolbox: {
                    feature: {
                        restore: { // 添加重置按钮
                            title: 'Reset',
                            icon: 'path://M0 0h24v24H0z', // 图标可以自定义或使用内置图标
                            show: true
                        },
                        dataZoom: {
                            yAxisIndex: 'none' // 只对 x 轴启用缩放
                        }
                    }
                }
            };

            // 使用刚指定的配置项和数据显示图表
            downloadVolumeChart.setOption(option);
        });
    </script>
</div>

<!-- 引入 Semantic UI 的 JS 库 -->
<script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js"></script>
</body>
</html>
