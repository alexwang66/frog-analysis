<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>File Download Volume Over Time</title>
    <!-- 引入 Semantic UI 样式表 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css">

    <!-- 引入 ECharts -->
    <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>

    <!-- 引入 jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
<div class="ui container">
    <h2 class="ui header">File Download Volume Over Time</h2>

    <!-- 创建一个用于展示 ECharts 图表的 div，设置宽度为 800px，高度为 1000px -->
    <div id="downloadVolumeChart" style="width: 800px; height: 1000px;"></div>

    <!-- 使用 Thymeleaf 渲染未转义的时间标签数据 -->
    <script type="text/javascript">
        $(document).ready(function() {
            // 初始化 ECharts 实例
            var downloadVolumeChart = echarts.init(document.getElementById('downloadVolumeChart'));

            // 指定图表的配置项和数据
            var option = {
                title: {
                    text: 'File Download Volume Over Time'
                },
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                xAxis: {
                    type: 'category',
                    data: [(${timeLabelsForJs})],  // 时间标签
                    axisLabel: {
                        formatter: function (value) {
                            return echarts.format.formatTime('MM/dd hh:mm', value);  // 格式化时间显示
                        }
                    },
                    name: 'Time (Hours)'
                },
                yAxis: {
                    type: 'value',
                    axisLabel: {
                        formatter: function (value) {
                            return (value / (1024 * 1024 * 1024)).toFixed(2) + ' GB';  // 字节转换成 GB 并显示
                        }
                    },
                    name: 'Download Volume (GB)'
                },
                series: [{
                    name: 'Download Volume (GB)',
                    type: 'bar',
                    data: [(${downloadVolumes})],  // 下载量
                    itemStyle: {
                        color: 'rgba(75, 192, 192, 0.8)'
                    }
                }],
                dataZoom: [
                    {
                        type: 'slider',
                        start: 0,
                        end: 100,
                        zoomLock: true,  // 锁定缩放范围，避免用户无意中缩得太小
                        maxValueSpan: 10,  // 最大可显示 10 个数据点
                        minValueSpan: 5    // 最小可显示 5 个数据点
                    },
                    {
                        type: 'inside',
                        zoomOnMouseWheel: true, // 鼠标滚轮滚动控制缩放
                        moveOnMouseMove: true  // 鼠标移动控制滚动
                    }
                ],
                toolbox: {
                    feature: {
                        dataZoom: {
                            yAxisIndex: 'none' // 仅在 X 轴上启用缩放
                        },
                        restore: {}, // 恢复按钮
                    }
                }
            };

            // 使用刚指定的配置项和数据显示图表
            downloadVolumeChart.setOption(option);
        });
    </script>
</div>

<!-- 引入 Semantic UI 的 JS 库 -->
<script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js"></script>
</body>
</html>
